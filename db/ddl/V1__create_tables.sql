/* =========================================================
   V1 - CREATE TABLES (CRIPTOMOEDA, USUARIO, APLICACAO)
   Compatível com Oracle 12c+: usa IDENTITY para chaves
   ========================================================= */
-- Crie o schema/usuário e conceda privilégios fora deste script, se necessário.

/* CRIPTOMOEDA: crie só se ainda não existir no seu banco */
CREATE TABLE CRIPTOMOEDA (
  ID_CRIPT     NUMBER GENERATED BY DEFAULT AS IDENTITY,
  NOME         VARCHAR2(100)   NOT NULL,
  SIGLA        VARCHAR2(10)    NOT NULL,
  VALOR_ATUAL  NUMBER(18,6)    NOT NULL,
  CONSTRAINT PK_CRIPTOMOEDA PRIMARY KEY (ID_CRIPT),
  CONSTRAINT UQ_CRIPTOMOEDA_SIGLA UNIQUE (SIGLA)
);

/* USUARIO */
CREATE TABLE USUARIO (
  ID_USUARIO  NUMBER GENERATED BY DEFAULT AS IDENTITY,
  NOME        VARCHAR2(100)        NOT NULL,
  CPF         VARCHAR2(11)         NOT NULL,
  TELEFONE    VARCHAR2(20),
  EMAIL       VARCHAR2(200)        NOT NULL,
  SENHA       VARCHAR2(200)        NOT NULL,
  CONSTRAINT PK_USUARIO PRIMARY KEY (ID_USUARIO),
  CONSTRAINT UQ_USUARIO_CPF   UNIQUE (CPF),
  CONSTRAINT UQ_USUARIO_EMAIL UNIQUE (EMAIL)
);

/* APLICACAO (sem FKs, adicionadas na V2) */
CREATE TABLE APLICACAO (
  ID_APLICACAO   NUMBER GENERATED BY DEFAULT AS IDENTITY,
  ID_USUARIO     NUMBER            NOT NULL,
  ID_CRIPT       NUMBER            NOT NULL,
  VALORINVESTIDO NUMBER(18,2)      NOT NULL,
  CONSTRAINT PK_APLICACAO PRIMARY KEY (ID_APLICACAO),
  CONSTRAINT CK_APLICACAO_VALOR_POS CHECK (VALORINVESTIDO > 0)
);
